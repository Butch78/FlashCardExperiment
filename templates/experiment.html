<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>{{title}}</title>
    <!-- Requires jQuery -->
    <script src="{{ url_for('static', filename='js/jquery.min.js')}}" type="text/javascript"></script>


    <link rel="stylesheet" media="all" href="{{ url_for('static', filename='css/style.css')}}" />
</head>

<body>

    <div>
        <p>
        <h1>Instructions</h1>
        </p>
        <p>We are now going to show you the LLM Generated FlashCards. The source Text is Highlighted on the left, the
            Generated FlashCard is on the right</p>
        <p>For the scientific validity of this experiment, it is vital that the review task is taken <b>very
                seriously</b>.
        </p>
        <ul>
            <li>Like in real life, you should <b>find as many defects as possible</b> and you should <b>spend as little
                    time
                    as possible</b> on the review.</li>
            <li>Unlike in real life, we are <b>not interested in maintainability or design issues</b>, but only in
                correctness issues ("bugs").</li>
        </ul>

        <p>For example, a remark like the following is beyond the goal of the review: "Create a new class which is
            implemented by runnable interface that we can access multiple times."
            Instead, what we are interested in are the defects that make the code not work as intended under all
            circumstances.</p>

        <p>Please assume that the code compiles and that the tests pass.</p>
        <p>
            To add a review remark, click on the corresponding line number. To delete a review mark, click on it again
            and
            delete the remark's text.<br><br>
        </p>

    </div>


    {% from "macros.html" import render_flashcard %}


    <div id="flashcards-container">
        {% for flashcard in flashcards %}
        <div class="flashcard-container" id="flashcard-{{ loop.index }}" style="display: none;">
            <div class="cards">
                {{ render_flashcard(flashcard) }}
            </div>
            <div class="questions">
                <form action="experiment" method="post" id="current_form">
                    {% for question in flashcard.questions %}
                    <fieldset class="container_radio_buttons">
                        <p>{{ question.text }}</p>
                        {% for option in question.options %}
                        <label>
                            <input type="radio" name="question_{{ option.id }}" value="{{ option.value }}"
                                class="option-input radio" required>
                            {{ option.text }}
                        </label><br>
                        {% endfor %}
                    </fieldset>
                    <br>
                    {% endfor %}
                    <button onclick="showNextFlashcard({{ loop.index }})" class="button blue">Submit & Next</button>
                </form>
            </div>
        </div>
        {% endfor %}
    </div>



    <script>
        // JavaScript to control the flashcard display
        document.addEventListener('DOMContentLoaded', (event) => {
            // Initially, show the first flashcard
            if (document.getElementById('flashcard-1')) {
                document.getElementById('flashcard-1').style.display = 'block';
            }
        });

        async function showNextFlashcard(currentIndex) {
            // Get the current flashcard
            var currentCard = document.getElementById('flashcard-' + currentIndex);

            // Check if a radio button is selected
            var radios = currentCard.getElementsByTagName('input');
            var selected = false;
            for (var i = 0; i < radios.length; i++) {
                if (radios[i].type === 'radio' && radios[i].checked) {
                    selected = true;
                    break;
                }
            }

            // If no radio button is selected, show an alert and return
            if (!selected) {
                alert('Please select a field before moving to the next card.');
                return;
            }

            // Get the form data
            var formData = new FormData(currentCard.querySelector('form'));

            // Send the form data
            try {
                const response = await fetch('/experiment', {
                    method: 'POST',
                    body: formData
                });

                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
            } catch (error) {
                console.error('Error:', error);
                return;
            }

            // Hide the current flashcard
            currentCard.style.display = 'none';

            // Show the next flashcard
            var nextIndex = currentIndex + 1;
            var nextCard = document.getElementById('flashcard-' + nextIndex);
            if (nextCard) {
                nextCard.style.display = 'block';
            } else {
                // No more flashcards - maybe show a completion message or redirect
                console.log('No more flashcards');
            }
        }
    </script>
</body>

</html>